library(diagram)
library(scales)
### Before surgery ######
pdf(file="Speed-Stroke-Model.pdf",height=10,width=10)
par(mar = c(1, 1, 1, 1))
 openplotmat(main="Slow Walking After Stroke")
 elpos <- coordinates (c(2,2,2))
 fromto <- matrix(ncol = 2, byrow = TRUE,data = c(2,1,2,4,1,3,4,6,5,6))
 nr <- nrow(fromto)
 arrpos <- matrix(ncol = 2, nrow = nr)
 for (i in 1:nr) arrpos[i, ] <- straightarrow (to = elpos[fromto[i, 2], ], from = elpos[fromto[i, 1], ], lwd = 2, arr.pos = 0.5, arr.length = 0.8)
curvedarrow(from = elpos[1, ], to = elpos[3, ], curve = 0.4, lty = 2, lcol = 2, arr.pos = 0.35)
curvedarrow(from = elpos[1, ], to = elpos[3, ], curve = 0.3, lty = 2, lcol = 2, arr.pos = 0.5)
curvedarrow(from = elpos[1, ], to = elpos[3, ], curve = 0.2, lty = 2, lcol = 2, arr.pos = 0.65)
curvedarrow(from = elpos[4, ], to = elpos[3, ], curve = 0.2, lty = 1, lcol = 1,lwd = 2, arr.pos = 0.5, arr.length = 0.8)
curvedarrow(from = elpos[3, ], to = elpos[4, ], curve = 0.2, lty = 1, lcol = 1,lwd = 2, arr.pos = 0.5, arr.length = 0.8)
textround(elpos[1,], 0.05,0.05, lab = "Stroke", shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
textround (elpos[2,], 0.08, 0.05,lab = "Advanced Age", shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
textround (elpos[4,], 0.1, 0.05,lab = "Insufficient Reserve", shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
textround(elpos[3,], 0.05, 0.05, lab = "Slow Speed",shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
textround(elpos[5,], 0.1, 0.05, lab = "Intercurrent Illness",shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
textround(elpos[6,], 0.05, 0.05, lab = "Death",col="white",box.col="black", shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
#   dd <- c(0.0, 0.025)
text(arrpos[2, 1] + .07, arrpos[2, 2], "Senescence")
text(arrpos[3, 1] - 0.11, arrpos[3, 2]+.099, "Spasticity",col=2,)
text(arrpos[3, 1] - 0.08, arrpos[3, 2]+.02, "Instability",col=2)
text(arrpos[3, 1] - 0.03, arrpos[3, 2]-.05, "Poor Clearance",col=2)
text(arrpos[4, 1] - 0.25, arrpos[4, 2] +0.1, "Reduced fitness")
text(arrpos[2, 1] - 0.25, arrpos[2,1] +0.11, "Increased Liklihood")
text(arrpos[4, 1] - 0.25, arrpos[4, 2] +.3, "Schrack et al 2010")
dev.off()
### After surgery ######
pdf(file="Speed-Stroke-Rx-Model.pdf",height=10,width=10)
par(mar = c(1, 1, 1, 1))
openplotmat(main="Faster Walking After Treatment",)
elpos <- coordinates (c(2,2,2))
fromto <- matrix(ncol = 2, byrow = TRUE,data = c(2,1,2,4,1,3,4,6,5,6))
nr <- nrow(fromto)
lred <-alpha("red",.5)
lblack <-alpha("black",.5)
arrpos <- matrix(ncol = 2, nrow = nr)
for (i in 1:nr) arrpos[i, ] <- straightarrow (to = elpos[fromto[i, 2], ], from = elpos[fromto[i, 1], ], lwd = 2, arr.pos = 0.5, arr.length = 0.8)
curvedarrow(from = elpos[1, ], to = elpos[3, ], curve = 0.4, lty = 2, lcol = 2, arr.pos = 0.35)
curvedarrow(from = elpos[1, ], to = elpos[3, ], curve = 0.3, lty = 2, lcol = lred, arr.pos = 0.5)
curvedarrow(from = elpos[1, ], to = elpos[3, ], curve = 0.2, lty = 2, lcol = lred, arr.pos = 0.65)
curvedarrow(from = elpos[4, ], to = elpos[3, ], curve = 0.2, lty = 1, lcol = 1,lwd = 2, arr.pos = 0.5, arr.length = 0.8)
curvedarrow(from = elpos[3, ], to = elpos[4, ], curve = 0.2, lty = 1, lcol = "blue",lwd = 6, arr.pos = 0.5, arr.length = 0.8)

straightarrow(from = elpos[4, ], to = elpos[6, ], lty = 1, lcol = "gray",lwd = 4, arr.pos = 0.5, arr.length = 0.8)
textround(elpos[1,], 0.05,0.05, lab = "Stroke", shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
textround (elpos[2,], 0.08, 0.05,lab = "Advanced Age", shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
textround (elpos[4,], 0.1, 0.05,lab = "Maintained Reserve", shadow.col = "gray", shadow.size = 0.005, cex = 1.5,col="blue")
textround(elpos[3,], 0.05, 0.05, lab = "Faster Speed",shadow.col = "gray", shadow.size = 0.005, cex = 1.5,col="blue")
textround(elpos[5,], 0.1, 0.05, lab = "Intercurrent Illness",shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
textround(elpos[6,], 0.05, 0.05, lab = "Death",col="black",box.col="darkgray", shadow.col = "gray", shadow.size = 0.005, cex = 1.5)
#   dd <- c(0.0, 0.025)
lred <-alpha("red",.5)
text(arrpos[2, 1] + .07, arrpos[2, 2], "Senescence")
text(arrpos[3, 1] - 0.11, arrpos[3, 2]+.099, "Spasticity",col=2,)
text(arrpos[3, 1] - 0.08, arrpos[3, 2]+.02, "Instability",col=lred)
text(arrpos[3, 1] - 0.03, arrpos[3, 2]-.05, "Poor Clearance",col=lred)
text(arrpos[4, 1] - 0.25, arrpos[4, 2] +0.1, "Improved fitness")
text(arrpos[2, 1] - 0.25, arrpos[2,1] +0.11, "Increased Liklihood")
text(arrpos[4, 1] - 0.25, arrpos[4, 2] +.3, "Schrack et al 2010")
dev.off()